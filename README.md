# Krater.Tests.js

## Описание

Библиотека для Юнит тестирования
Позволяет проводить юнит-тесты.


## Принцип работы

Тестирование проводится в несколько этапов:
    - Тестировщик проверяет все переданные ему классы Юнит-тестов.
    - Тестировщик сроит очередь тестирования. На этом этапе создаются экземпляры (объекты) Юнит-тестов.
    - Производится инициализация тестировщика. У всех Юнит-тестов поочерёдно вызывается метод `OnInit()`. Ошибки на этом этапе приводят к экстренному завершению тестирования.
    - Этап тестирования. К каждому Юнит-тесту применяются следующие действия:
        1) Вызов метода `OnTestStart()`;
        2) Для каждого тестового метода производятся вызовы: метод `OnTestMethodStart()`; сам тестовый метод; метод `OnTestMethodEnd()`.
        3) Вызов метода `OnTestEnd()`;
    Ошибки в методах `OnTestStart()` и `OnTestEnd()` прерывают выполнение текущего Юнит-теста.
    Ошибки в тестовом методе, `OnTestMethodStart()` и `OnTestMethodEnd()` приводят к провалу этого теста (но не всего Юнит-теста).
    - Завершение работы тестировщика.  У всех Юнит-тестов поочерёдно вызывается метод `OnEnd()`. Ошибки на этом этапе приводят к экстренному завершению тестирования.
Все действия тестировщика выводятся в консоль.


## Инструкция. 

### Минимальный Юнит-тест

Ниже приведён алгорит создания самого простого Юнит-теста.
1) Создайте класс теста. Ваш класс должен наследовать от класса `UnitTest`. Подключить его можно следующим образом:
    ```javascript
    var {UnitTest} = require('krater.tests');
    ```

2) Создайте тестирующий метод класса следуя следующим правилам: имя метода должно начинаться с `Test`; метод должен быть перечеслимым свойством объекта класса; метод должен быть собственным свойством объекта класса; метод не должен использовать входные параметры. Пример тестирующего метода:
    ```javascript
    var {Assert} = require('krater.tests');

    Test_sum_2and2_4 = function() {
        let expected = 2 + 2;
        let actual = 4;
        Assert.AreEqual(expected, actual);
    }
    ```
Как можно видеть в методе используется функция `Assert.AreEqual`. Данная функция сравнивает два значения и генерирует ошибку, если они не равны.

3) В основном скрипте подключите ваш класс теста. Также, подключите класс тестировщика:
    ```javascript
    var {Test} = require('krater.tests');
    ```

4) Далее можно использовать два варианта проведения теестирования:
    а) Использовать функцию `Test.Run()`, для быстрого запуска тестов;
    б) Зарегистрировать свои тесты у тестировщика c помощью функции `Test.Add()`. Далее запустить все зарегистрированные тесты функцией `Test.RunAll()`.

5) Запустить основной скрипт, и проверьте консоль отладки.


#### Полные листинги

* Файл класса Юнит-теста 'MyTest.js':
    ```javascript
    var {UnitTest, Assert} = require('krater.tests');

    class MyTest extends UnitTest {
        constructor() {
            super();
        }
        Test_sum_2and2_4 = function() {
            let expected = 2 + 2;
            let actual = 4;
            Assert.AreEqual(expected, actual);
        }
    }
    ```

* Файл основного скрипта `test.js`:
    ```javascript
    var MyTest = require('./MyTest');
    var {Test} = require('krater.tests');

    Test.Run([ MyTest ]);
    ```


### Методы класса UnitTest

*`OnInit()` - Выполняется один раз перед запуском всех тестов текущей сборки.
*`OnEnd()` - Выполняется один раз после завершения всех тестов текущей сборки.
*`OnTestStart()` - Выполняется один раз перед началом выполнения всех тестов этого класса.
*`OnTestEnd()` - Выполняется один раз после завершения выполнения всех тестов этого класса.
*`OnTestMethodStart()` - Выполняется каждый раз перед выполнением теста этого класса.
*`OnTestMethodEnd()` - Выполняется каждый раз после выполнения теста этого класса.


### Методы статического класса Test

*`IsTest(source)` - Проверяет, является ли указанный ресурс тестом. Параметры:
    {*} source - Ресурс (класс).

*`Add(...tests)` - Добавляет указанные тесты в общую очередь тестирования. Параметры:
    {...any} tests - Классы тестов для добавления.

*`Run(tests, force)` - Запускает указанные тесты. Параметры:
    {*|*[]} tests - Классы тестов для запуска.
    {*} [force=false] - Если true, тесты не прошедшие проверку будут проигнорированы, а всел остальные тесты запустятся в штатном режиме.

*`RunAll(...tests)` - Запускает все тесты из общей очереди тестирования.


### Объект Assert

Содержит общие методы проверки тестируемых объектов. Методы:

*`AreEqual(expected, actual, message)` - Проверяет равенство двух значений (значение1 == значение2). Если значения не равны, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {*} actual - Необходимое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotEqual(expected, actual, message)` - Проверяет неравенство двух значений (значение1 != значение2). Если значения равны, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {*} actual - Необходимое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreIdenty(expected, actual, message)` - Проверяет эквивалентность двух значений (значение1 === значение2). Если значения не эквивалентны, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {*} actual - Необходимое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotIdenty(expected, actual, message)` - Проверяет неэквивалентность двух значений (значение1 !== значение2). Если значения эквивалентны, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {*} actual - Необходимое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`Fail()` - Генерирует ошибку AssertFailedError. Параметры:
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsTrue(expected, message)` - Проверяет равенство указанного значения и true (значение == true). Если значение не равно true, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsFalse(expected, message)` - Проверяет равенство указанного значения и false (значение == false). Если значение не равно false, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsNull(expected, message)` - Проверяет эквивалентность указанного значения и null (значение === null). Если значение не эквивалентно null, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsNotNull(expected, message)` - Проверяет неэквивалентность указанного значения и null (значение !== null). Если значение эквивалентно null, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsUndefined(expected, message)` - Проверяет эквивалентность указанного значения и undefined (значение === undefined). Если значение не эквивалентно undefined, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsNotUndefined(expected, message)` - Проверяет неэквивалентность указанного значения и undefined (значение !== undefined). Если значение эквивалентно undefined, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreTypeOf(expected, type, message)` - Проверяет соответствие типа значения и  указанного типа (typeof <значение> === <тип>). Если тип значения не соответствует указанному типу, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} type - Необходимый тип.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotTypeOf(expected, type, message)` - Проверяет несоответствие типа значения и указанного типа (typeof <значение> !== <тип>). Если тип значения соответствует указанному типу, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемое значение.
    {string} type - Необходимый тип.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreInstenceOf(expected, type, message)` - Проверяет соответствие типа объекта и указанного типа (<значение> instanceof <тип>). Если тип объекта не соответствует указанному типу, то генерируется ошибка AssertFailedError. Параметры:
    {*} expected - Проверяемый объект.
    {string} type - Необходимый тип.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotInstenceOf(expected, type, message)` - Проверяет соответствие типа объекта и указанного типа (!(<значение> instanceof <тип>)). Если тип объекта соответствует указанному типу, то генерируется ошибка AssertFailedError.. Параметры:
    {*} expected - Проверяемый объект.
    {string} type - Необходимый тип.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`ThrowError(func, args, thisArg, message)` - Проверяет генерирует ли указанная функция при выполнении ошибку. Если функция при выполнении не генерирует ошибку, то генерируется ошибка AssertFailedError. Параметры:
    {*} func - Выполняемая функция.
    {*|*[]} [args] - Параметры, передаваемые в функцию при её выполнении.
    {*} [thisArg] - Контекст выполнения функции.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`ThrowErrorIsType(func, args, thisArg, errorType, message)` - Проверяет генерирует ли указанная функция при выполнении ошибку указанного типа. Если функция при выполнении не генерирует ошибку указанного типа, то генерируется ошибка AssertFailedError. Параметры:
    {*} func - Выполняемая функция.
    {*|*[]} [args] - Параметры, передаваемые в функцию при её выполнении.
    {*} [thisArg] - Контекст выполнения функции.
    {*} [errorType] - Тип ошибки.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.


### Объект ArrayAssert

Содержит методы проверки массивов. Методы:

*`AllItemsInstenceOf(expected, type, message)` - Проверяет являются ли все элементы массива объектами указанного типа. Если не все элементы массива являются объектами указанного типа, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {*} type - Тип.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AllItemsTypeOf(expected, type, message)` - Проверяет являются ли все элементы массива значениями указанного типа. Если не все элементы массива являются значениями указанного типа, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {*} type - Тип.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AllItemsIsNotNull(expected, message)` - Проверяет не содержит ли массив элемент, являющийся null. Если массив содержит элемент, являющийся null, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AllItemsIsNotUndefined(expected, message)` - Проверяет не содержит ли массив элемент, являющийся undefined. Если массив содержит элемент, являющийся undefined,  то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AllItemsIsNotNullOrUndefined(expected, message)` - Проверяет не содержит ли массив элемент, являющийся null или undefined. Если массив содержит элемент, являющийся null или undefined, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AllItemsAreUnique(expected, message)` - Проверяет являются ли все элементы массива уникальными. Если любые два элемента массива равны, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreIdenty(expected, actual, message)` - Проверяет эквивалентность двух массивов. Если массивы не эквивалентны, то генерируется ошибка AssertFailedError. Эквивалентность определяется как наличие одних и тех же (эквивалентных) элементов в обоих массивах в одном и том же порядке и количестве. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} actual - Контрольный массив.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotIdenty(expected, actual, message)` - Проверяет неэквивалентность двух массивов. Если массивы эквивалентны, то генерируется ошибка AssertFailedError. Эквивалентность определяется как наличие одних и тех же (эквивалентных) элементов в обоих массивах в одном и том же порядке и количестве. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} actual - Контрольный массив.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreEqual(expected, actual, comparer, message)` - Проверяет равенство двух массивов. Если массивы не равны, то генерируется ошибка AssertFailedError. Равенство определяется как наличие одних и тех же (равных) элементов в обоих массивах в одном и том же порядке и количестве. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} actual - Контрольный массив.
    {function} [comparer=(a,b)=>a==b] - Функция, которая будет савнивать элементы массивов. Функция должна иметь вид (a, b) => result, где a и b - элементы массивов, result - результат сравнения типа boolean.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotEqual(expected, actual, comparer, message)` - Проверяет неравенство двух массивов. Если массивы равны, то генерируется ошибка AssertFailedError. Равенство определяется как наличие одних и тех же (равных) элементов в обоих массивах в одном и том же порядке и количестве. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} actual - Контрольный массив.
    {function} [comparer=(a,b)=>a==b] - Функция, которая будет савнивать элементы массивов. Функция должна иметь вид (a, b) => result, где a и b - элементы массивов, result - результат сравнения типа boolean.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreEquivalent(expected, actual, comparer, message)` - Проверяет равенство двух массивов. Если массивы не равны, то генерируется ошибка AssertFailedError. Равенство определяется как наличие одних и тех же (равных) элементов в обоих массивах в одном и том же количестве, их порядок не важен. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} actual - Контрольный массив.
    {function} [comparer=(a,b)=>a==b] - Функция, которая будет савнивать элементы массивов. Функция должна иметь вид (a, b) => result, где a и b - элементы массивов, result - результат сравнения типа boolean.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`AreNotEquivalent(expected, actual, comparer, message)` - Проверяет неравенство двух массивов. Если массивы равны, то генерируется ошибка AssertFailedError. Равенство определяется как наличие одних и тех же (равных) элементов в обоих массивах в одном и том же количестве, их порядок не важен. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} actual - Контрольный массив.
    {function} [comparer=(a,b)=>a==b] - Функция, которая будет савнивать элементы массивов. Функция должна иметь вид (a, b) => result, где a и b - элементы массивов, result - результат сравнения типа boolean.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`Contains(expected, element, message)` - Проверяет содержит ли массив указанный элемент. Если массив не содержит указанный элемент, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {*} element - Элемент.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`NotContains(expected, element, message)` - Проверяет не содержит ли массив указанный элемент. Если массив содержит указанный элемент, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {*} element - Элемент.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsSubsetOf(expected, superset, message)` - Проверяет является ли массив подмножеством указанного множества. Если массив не является подмножеством указанного множества, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} superset - Контрольное множество.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`IsNotSubsetOf(expected, superset, message)` - Проверяет не является ли массив подмножеством указанного множества. Если массив является подмножеством указанного множества, то генерируется ошибка AssertFailedError. Параметры:
    {Array} expected - Проверяемый массив.
    {Array} superset - Контрольное множество.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.


### Объект StringAssert

Содержит методы проверки строк. Методы:

*`Contains(expected, substring, message)` - Проверяет (с учетом регистра) содержит ли строка указанную подстроку. Если строка не содержит указанную подстроку, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} substring - Подстрока.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`NotContains(expected, substring, message)` - Проверяет (с учетом регистра) не содержит ли строка указанную подстроку. Если строка содержит указанную подстроку, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} substring - Подстрока.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`StartsWith(expected, substring, message)` - Проверяет (с учетом регистра) начинается ли строка с указанной подстроки. Если строка не начинается с указанной подстроки, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} substring - Подстрока.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`NotStartsWith(expected, substring, message)` - Проверяет (с учетом регистра) не начинается ли строка с указанной подстроки. Если строка начинается с указанной подстроки, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} substring - Подстрока.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`EndsWith(expected, substring, message)` - Проверяет (с учетом регистра) заканчивается ли строка указанной подстрокой. Если строка не заканчивается указанной подстрокой, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} substring - Подстрока.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`NotEndsWith(expected, substring, message)` - Проверяет (с учетом регистра) не заканчивается ли строка указанной подстрокой. Если строка заканчивается указанной подстрокой, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} substring - Подстрока.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`Matches(expected, regexp, message)` - Проверяет соответствует ли строка регулярному выражению. Если строка не соответствует регулярному выражению, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} regexp - Регулярное выражение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.

*`NotMatches(expected, regexp, message)` - Проверяет не соответствует ли строка регулярному выражению. Если строка соответствует регулярному выражению, то генерируется ошибка AssertFailedError. Параметры:
    {string} expected - Проверяемая строка.
    {string} regexp - Регулярное выражение.
    {string} [message] - Сообщение, которое будет показано при генерации ошибки `AssertFailedError`.
